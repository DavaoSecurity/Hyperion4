#!/bin/bash
# Hyperion v4 https://github.com/Err0r-ICA/Searchsploit
# INSTALL FIRST
# git clone https://www.github.com/Err0r-ICA/Searchsploit
# cd Searchsploit
# bash install.sh
# ./Searchsploit
searchsploit update
d=$1 # IP address eg 8.8.8.8
y=$3 # OS version eg Ubuntu 20.0.04 ot Windows Server 2016 R2

# checks all results in Nmap's XML output with service version
sudo nmap -vv $1 --script exploit -p - -oX nex.xml
xsltproc nex.xml -o nmapexploit.html
# searchsplpoit using nmap output above
searchsploit --nmap nex.xml -w  > nexploit.txt
cat nexploit.txt | grep CVE > exploit.txt
sed -i '1i Exploitdb Search From NMap Scan\n---------------------------------------' exploitnmap.txt
# searchsploit using OS supplied by user
searchsploit $3 -w > exp.txt
#cat exp.txt | grep CVE > exdb.txt
sed -i '1i Exploitdb Search for Known Exploit Code with user supplied OS\n--------------------------------------------------------------' exp.txt

# zip
pass=$(openssl rand -base64 6)
zip --password ${pass} exploitnmap.zip nmapexploit.html exploitnmap.txt exp.txt

# clean up
rm nmapexploit.html exploitnmap.txt exp.txt
